<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Postermania</title>
    <link rel="icon" type="image/x-icon" href="favicon.png">
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts: Chakra Petch for headings, Space Mono for body -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Chakra+Petch:wght@700&family=Space+Mono:wght@400&display=swap" rel="stylesheet">
    <style>
        /* Custom styles for the new theme */
        body {
            font-family: 'Space Mono', monospace;
            background-color: #111827; /* Dark background (bg-gray-900) */
            /* Subtle grid pattern for a techy look */
            background-image: 
                linear-gradient(rgba(255, 255, 255, 0.05) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255, 255, 255, 0.05) 1px, transparent 1px);
            background-size: 30px 30px;
        }
        
        h1, h2, h3 { font-family: 'Chakra Petch', sans-serif; }

        .poster-card {
            position: relative; /* Required for the "new" indicator */
            background-color: rgba(31, 41, 55, 0.5);
            border: 1px solid #4b5563;
            backdrop-filter: blur(8px);
            transition: transform 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease, opacity 0.4s ease, max-height 0.5s ease, margin 0.5s, padding 0.5s;
            overflow: hidden;
            max-height: 1000px;
        }
        .poster-card:hover {
            transform: translateY(-8px) skewX(-3deg);
            border-color: #a78bfa;
            box-shadow: 0 0 25px rgba(167, 139, 250, 0.4);
        }
        .poster-card.hidden {
            opacity: 0; transform: scale(0.9); max-height: 0;
            margin-top: 0; margin-bottom: 0; padding-top: 0;
            padding-bottom: 0; border-width: 0;
        }

        /* "New" Indicator styles */
        .new-indicator {
            position: absolute;
            top: 12px;
            right: 12px;
            width: 24px;
            height: 24px;
            background-color: #a78bfa;
            color: #111827;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 16px;
            z-index: 10;
            box-shadow: 0 0 10px rgba(167, 139, 250, 0.7);
            transition: opacity 0.3s ease, transform 0.3s ease;
            transform: scale(1);
        }
        .poster-card.viewed .new-indicator {
            opacity: 0;
            transform: scale(0);
        }

        #modal { transition: opacity 0.3s ease, visibility 0.3s ease; }
        #modal-content {
            border: 1px solid #a78bfa; background-color: #1f2937;
            transition: transform 0.3s ease;
            box-shadow: 0 0 30px rgba(167, 139, 250, 0.5);
        }
        
        body.modal-open { overflow: hidden; }

        /* Scroll Animation Styles */
        .animate-on-scroll {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.5s ease-out, transform 0.5s ease-out;
        }
        .animate-on-scroll.is-visible {
            opacity: 1;
            transform: translateY(0);
        }

        #glitch-heading { position: relative; animation: glitch-skew 1s infinite linear alternate-reverse; }
        #glitch-heading::before, #glitch-heading::after {
            content: attr(data-text); position: absolute; top: 0; left: 0;
            width: 100%; height: 100%;
        }
        #glitch-heading::before {
            left: 2px; text-shadow: -2px 0 #ff00c1;
            clip-path: polygon(0 0, 100% 0, 100% 45%, 0 45%);
            animation: glitch-anim 5s infinite linear alternate-reverse;
        }
        #glitch-heading::after {
            left: -2px; text-shadow: -2px 0 #00fff9, 2px 2px #ff00c1;
            clip-path: polygon(0 50%, 100% 50%, 100% 100%, 0 100%);
            animation: glitch-anim2 5s infinite linear alternate-reverse;
        }
        @keyframes glitch-anim { 0% { clip-path: polygon(0 2%, 100% 2%, 100% 23%, 0 23%); } 5% { clip-path: polygon(0 63%, 100% 63%, 100% 88%, 0 88%); } 100% { clip-path: polygon(0 42%, 100% 42%, 100% 58%, 0 58%); } }
        @keyframes glitch-anim2 { 0% { clip-path: polygon(0 67%, 100% 67%, 100% 89%, 0 89%); } 6% { clip-path: polygon(0 8%, 100% 8%, 100% 38%, 0 38%); } 100% { clip-path: polygon(0 55%, 100% 55%, 100% 64%, 0 64%); } }
        @keyframes glitch-skew { 0% { transform: skew(0deg); } 1% { transform: skew(1deg); } 2% { transform: skew(0deg); } 3% { transform: skew(-1deg); } 4% { transform: skew(0deg); } 100% { transform: skew(0deg); } }

        #to-top-button { transition: opacity 0.3s, visibility 0.3s; }

        .filter-btn {
            background-color: rgba(31, 41, 55, 0.5); border: 1px solid #4b5563;
            transition: background-color 0.3s, border-color 0.3s, color 0.3s;
        }
        .filter-btn:hover { background-color: rgba(55, 65, 81, 0.7); border-color: #6b7280; }
        .filter-btn.active {
            background-color: #a78bfa; border-color: #a78bfa;
            color: #111827; font-weight: bold;
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-300">

    <!-- Header Section -->
    <header class="sticky top-0 z-20 bg-gray-900/70 backdrop-blur-md border-b border-gray-700">
        <div class="container mx-auto px-6 py-4">
            <h1 id="glitch-heading" data-text="POSTERMANIA" class="text-2xl md:text-3xl font-bold text-white tracking-wider">POSTERMANIA</h1>
            <p class="mt-1 text-gray-400">Declassified design projects and visual experiments.</p>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-6 py-12">
        <p class="text-center text-lg text-gray-400 mb-12 max-w-2xl mx-auto">
            Welcome to my personal gallery. Each poster represents a story, a burst of creativity, or a design challenge. Click any poster to see a larger version and learn more.
        </p>
        
        <section id="about" class="mb-16 p-8 rounded-lg border border-gray-700 bg-gray-800/50 backdrop-blur-md">
            <h2 class="text-2xl font-bold text-violet-400 text-center mb-4">ABOUT THE ARTIST</h2>
            <p class="text-center max-w-3xl mx-auto text-gray-400">
                I'm a digital artist and graphic designer passionate about blending futuristic aesthetics with modern typography. This space is my visual playground—a collection of personal projects, experiments, and client work. My goal is to push creative boundaries and explore new techniques.
            </p>
        </section>

        <div id="filter-container" class="flex justify-center flex-wrap gap-2 md:gap-4 mb-12">
            <button class="filter-btn active px-4 py-2 rounded-md text-sm font-medium" data-filter="all">ALL</button>
            <button class="filter-btn px-4 py-2 rounded-md text-sm font-medium" data-filter="featured">FEATURED</button>
            <button class="filter-btn px-4 py-2 rounded-md text-sm font-medium" data-filter="glass">LIQUID GLASS</button>
            <button class="filter-btn px-4 py-2 rounded-md text-sm font-medium" data-filter="ai">AI EXPERIMENTS</button>
            <button class="filter-btn px-4 py-2 rounded-md text-sm font-medium" data-filter="typography">TYPOGRAPHY</button>
        </div>

        <div id="gallery" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8 md:gap-10">
            
             <!-- NEW Full-Width Poster Placeholder -->
            <div class="poster-card animate-on-scroll rounded-lg overflow-hidden cursor-pointer lg:col-span-3" data-category="featured" data-poster-id="featured-2" onclick="openModal(this)">
                <span class="new-indicator">!</span>
                <img loading="lazy" src="comp_posters/featured2.png" alt="Featured2" class="w-full h-auto" data-large-src="comp_posters/featured2.png">
                <div class="p-5">
                    <h3 class="text-2xl font-semibold text-violet-400">Postermania Banner</h3>
                    <p class="text-gray-400 mt-1">The new Postermania featured banner.</p>
                </div>
            </div>

            <!-- OLD Featured Poster (Now Archived from main view) -->
            <div class="poster-card animate-on-scroll rounded-lg overflow-hidden cursor-pointer lg:col-span-3" data-category="featured" data-main-visible="false" data-poster-id="featured-1" onclick="openModal(this)">
                <span class="new-indicator">!</span>
                <img loading="lazy" src="comp_posters/featured.png" alt="Featured" class="w-full h-auto" data-large-src="comp_posters/featured.png">
                <div class="p-5">
                    <h3 class="text-xl font-semibold text-violet-400">Featured Postermania Banner</h3>
                    <p class="text-gray-400 mt-1">This was the first featured poster. It's now archived from the 'All' view.</p>
                </div>
            </div>


            <div class="poster-card animate-on-scroll rounded-lg overflow-hidden cursor-pointer" data-category="typography" data-poster-id="poster-1" onclick="openModal(this)">
                <span class="new-indicator">!</span>
                <img loading="lazy" src="comp_posters/SLEEP TOKEN.jpg" alt="Sleep Token" class="w-full h-auto" data-large-src="comp_posters/SLEEP TOKEN.jpg">
                <div class="p-5"><h3 class="text-xl font-semibold text-violet-400">Sleep Token - Infinite Baths</h3><p class="text-gray-400 mt-1">Monoprinting and digitalisation test along with lyric prints.</p></div>
            </div>
            <div class="poster-card animate-on-scroll rounded-lg overflow-hidden cursor-pointer" data-category="glass" data-poster-id="poster-2" onclick="openModal(this)">
                 <span class="new-indicator">!</span>
                <img loading="lazy" src="comp_posters/a4color_esdeekid.jpg" alt="EsDeeKid" class="w-full h-auto" data-large-src="comp_posters/a4color_esdeekid.jpg">
                <div class="p-5"><h3 class="text-xl font-semibold text-violet-400">EsDeeKid - Cali Man</h3><p class="text-gray-400 mt-1">Again with the liquid glass.</p></div>
            </div>
            <div class="poster-card animate-on-scroll rounded-lg overflow-hidden cursor-pointer" data-category="ai glass" data-poster-id="poster-3" onclick="openModal(this)">
                 <span class="new-indicator">!</span>
                <img loading="lazy" src="comp_posters/Tyler The Creator.jpg" alt="Tyler The Creator" class="w-full h-auto" data-large-src="comp_posters/Tyler The Creator.jpg">
                <div class="p-5"><h3 class="text-xl font-semibold text-violet-400">Tyler The Creator - See You Again</h3><p class="text-gray-400 mt-1">AI experimentation along with liquid glass technique.</p></div>
            </div>

            <div class="poster-card animate-on-scroll rounded-lg overflow-hidden cursor-pointer" data-category="typography" data-poster-id="poster-4" onclick="openModal(this)">
                 <span class="new-indicator">!</span>
                <img loading="lazy" src="comp_posters/heavyweight.jpg" alt="Yeat" class="w-full h-auto" data-large-src="comp_posters/heavyweight.jpg">
                <div class="p-5"><h3 class="text-xl font-semibold text-violet-400">Yeat - Hëavyweight</h3><p class="text-gray-400 mt-1">Full brainstorming.</p></div>
            </div>
            <div class="poster-card animate-on-scroll rounded-lg overflow-hidden cursor-pointer" data-category="glass" data-poster-id="poster-5" onclick="openModal(this)">
                 <span class="new-indicator">!</span>
                <img loading="lazy" src="comp_posters/Untitled-1.jpg" alt="Jessie Murph" class="w-full h-auto" data-large-src="comp_posters/Untitled-1.jpg">
                <div class="p-5"><h3 class="text-xl font-semibold text-violet-400">Jessie Murph - Always Been You</h3><p class="text-gray-400 mt-1">Taking requests from my friends and their favourite artists.</p></div>
            </div>
            <div class="poster-card animate-on-scroll rounded-lg overflow-hidden cursor-pointer" data-category="typography" data-poster-id="poster-6" onclick="openModal(this)">
                 <span class="new-indicator">!</span>
                <img loading="lazy" src="comp_posters/dave.jpg" alt="Dave" class="w-full h-auto" data-large-src="comp_posters/dave.jpg">
                <div class="p-5"><h3 class="text-xl font-semibold text-violet-400">Santan Dave - We Are All Alone In This Together</h3><p class="text-gray-400 mt-1">Typography and texture printing.</p></div>
            </div>
            <div class="poster-card animate-on-scroll rounded-lg overflow-hidden cursor-pointer" data-category="glass" data-poster-id="poster-7" onclick="openModal(this)">
                 <span class="new-indicator">!</span>
                <img loading="lazy" src="comp_posters/Yeat.jpg" alt="Yeat" class="w-full h-auto" data-large-src="comp_posters/Yeat.jpg">
                <div class="p-5"><h3 class="text-xl font-semibold text-violet-400">Yeat - Comë n Go</h3><p class="text-gray-400 mt-1">A test with Apple's Liquid Glass technique.</p></div>
            </div>
        </div>
    </main>
    
    <!-- Poster Request Form Section -->
    <section id="contact" class="container mx-auto px-6 py-12">
        <div class="p-8 rounded-lg border border-gray-700 bg-gray-800/50 backdrop-blur-md max-w-3xl mx-auto">
            <h2 class="text-2xl font-bold text-violet-400 text-center mb-2">REQUEST A POSTER</h2>
            <p class="text-center text-gray-400 mb-6">Have an idea for a poster? Fill out the form below and I'll consider it for a future design. (with credits towards you)</p>
            <form action="https://formspree.io/f/mwprwrzj" method="POST" class="space-y-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label for="artist" class="block text-sm font-medium text-gray-400 mb-2">Artist Name</label>
                        <input type="text" name="Artist" id="artist" required class="w-full bg-gray-900/50 border border-gray-600 rounded-md p-3 text-white focus:ring-violet-400 focus:border-violet-400 transition">
                    </div>
                    <div>
                        <label for="album" class="block text-sm font-medium text-gray-400 mb-2">Album / Single Name</label>
                        <input type="text" name="Album" id="album" required class="w-full bg-gray-900/50 border border-gray-600 rounded-md p-3 text-white focus:ring-violet-400 focus:border-violet-400 transition">
                    </div>
                </div>
                 <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label for="song" class="block text-sm font-medium text-gray-400 mb-2">Specific Song (Optional)</label>
                        <input type="text" name="Song" id="song" class="w-full bg-gray-900/50 border border-gray-600 rounded-md p-3 text-white focus:ring-violet-400 focus:border-violet-400 transition">
                    </div>
                    <div>
                        <label for="style" class="block text-sm font-medium text-gray-400 mb-2">Desired Style (e.g., Liquid Glass, Vintage)</label>
                        <input type="text" name="Style" id="style" required class="w-full bg-gray-900/50 border border-gray-600 rounded-md p-3 text-white focus:ring-violet-400 focus:border-violet-400 transition">
                    </div>
                </div>
                 <div>
                    <label for="email" class="block text-sm font-medium text-gray-400 mb-2">Your Email (To notify you if it gets made)</label>
                    <input type="email" name="Email" id="email" required class="w-full bg-gray-900/50 border border-gray-600 rounded-md p-3 text-white focus:ring-violet-400 focus:border-violet-400 transition">
                </div>
                <div>
                    <label for="Details" class="block text-sm font-medium text-gray-400 mb-2">Additional Details</label>
                    <textarea name="Details" id="details" rows="4" class="w-full bg-gray-900/50 border border-gray-600 rounded-md p-3 text-white focus:ring-violet-400 focus:border-violet-400 transition"></textarea>
                </div>
                <button type="submit" class="w-full filter-btn active px-4 py-3 rounded-md font-bold">SUBMIT REQUEST</button>
            </form>
        </div>
    </section>

    <footer class="bg-gray-900/70 mt-12 border-t border-gray-700">
        <div class="container mx-auto px-6 py-8 text-center text-gray-500">
            <div class="flex justify-center gap-6 mb-6">
                <a href="#" class="text-gray-500 hover:text-violet-400 transition-colors"><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zM5.538 16.95c.538-.962 1.637-2.31 2.394-3.508c-.75-1.125-1.462-2.5-1.462-2.5s.45-1.2 1.763-1.462c1.312-.263 3.3.637 3.3.637l.45-1.725c.188-.713-1.088-3.413-1.088-3.413s2.475 1.575 2.85 3.825c.375 2.25-1.238 4.238-1.238 4.238s-2.025.975-2.025.975l.188.713c.75 2.812 2.662 4.987 2.662 4.987c-1.5.3-5.213-1.012-6.6-4.237z" clip-rule="evenodd" /></svg></a>
                <a href="#" class="text-gray-500 hover:text-violet-400 transition-colors"><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M12 2C6.477 2 2 6.477 2 12c0 4.418 2.865 8.168 6.839 9.492c.5.092.682-.217.682-.482c0-.237-.009-.868-.014-1.703c-2.782.605-3.369-1.343-3.369-1.343c-.454-1.158-1.11-1.466-1.11-1.466c-.908-.62.069-.608.069-.608c1.003.07 1.531 1.032 1.531 1.032c.892 1.53 2.341 1.088 2.91.832c.092-.647.35-1.088.636-1.338c-2.22-.253-4.555-1.113-4.555-4.951c0-1.093.39-1.988 1.03-2.688c-.103-.253-.446-1.272.098-2.65c0 0 .84-.27 2.75 1.026A9.564 9.564 0 0 1 12 6.844c.85.004 1.705.115 2.504.337c1.909-1.296 2.747-1.027 2.747-1.027c.546 1.379.203 2.398.1 2.65c.64.7 1.028 1.595 1.028 2.688c0 3.848-2.338 4.695-4.566 4.942c.359.308.678.92.678 1.855c0 1.338-.012 2.419-.012 2.747c0 .268.18.58.688.482A10.001 10.001 0 0 0 22 12c0-5.523-4.477-10-10-10z" clip-rule="evenodd" /></svg></a>
            </div>
            <p>&copy; 2025 Postermania // All Rights Reserved.</p>
            <!--<p class="mt-2">Signal inbound: <a href="mailto:dumitruc.rob@gmail.com" class="text-violet-400 hover:underline">dumitruc.rob@gmail.com</a></p>-->
        </div>
    </footer>

    <div id="modal" class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-80 backdrop-blur-sm invisible opacity-0" onclick="closeModal()">
        <div id="modal-content" class="relative rounded-lg shadow-2xl max-w-4xl w-11/12 max-h-[90vh] flex flex-col md:flex-row transform scale-95" onclick="event.stopPropagation()">
            <button onclick="closeModal()" class="absolute -top-4 -right-4 bg-gray-800 rounded-full p-2 shadow-lg hover:bg-gray-700 border border-violet-400 transition-colors z-30">
                <svg class="h-6 w-6 text-violet-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
            </button>
            <div class="relative flex-grow flex items-center justify-center md:w-2/3">
                 <img id="modal-img" src="" alt="Enlarged Poster" class="rounded-t-lg md:rounded-l-lg md:rounded-t-none w-auto max-w-full h-auto max-h-[90vh] object-contain bg-black/20">
                 <div id="modal-text-content" class="absolute bottom-0 left-0 w-full p-6 bg-gradient-to-t from-black/80 to-transparent text-white md:hidden">
                    <h3 id="modal-title-mobile" class="text-xl font-bold"></h3>
                    <p id="modal-description-mobile" class="text-sm mt-1"></p>
                 </div>
            </div>
            <div class="p-6 md:flex flex-col justify-center md:w-1/3 hidden">
                <h3 id="modal-title" class="text-2xl font-bold text-violet-400"></h3>
                <p id="modal-description" class="text-gray-300 mt-2"></p>
            </div>
        </div>
        <!-- Lightbox Navigation -->
        <button id="prev-btn" class="absolute left-4 top-1/2 -translate-y-1/2 bg-gray-800/50 rounded-full p-2 text-white hover:bg-gray-700/70 z-20">
            <svg class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" /></svg>
        </button>
        <button id="next-btn" class="absolute right-4 top-1/2 -translate-y-1/2 bg-gray-800/50 rounded-full p-2 text-white hover:bg-gray-700/70 z-20">
            <svg class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
        </button>
    </div>

    <button id="to-top-button" class="fixed bottom-5 right-5 bg-violet-500/50 text-white p-3 rounded-full shadow-lg hover:bg-violet-500/80 backdrop-blur-sm border border-violet-400 invisible opacity-0 z-10">
         <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M5 15l7-7 7 7" /></svg>
    </button>

    <script>
        // --- DOM Elements ---
        const modal = document.getElementById('modal');
        const modalImg = document.getElementById('modal-img');
        const modalTitle = document.getElementById('modal-title');
        const modalDescription = document.getElementById('modal-description');
        const modalTitleMobile = document.getElementById('modal-title-mobile');
        const modalDescriptionMobile = document.getElementById('modal-description-mobile');
        const modalContent = document.getElementById('modal-content');
        const toTopButton = document.getElementById('to-top-button');
        const filterContainer = document.getElementById('filter-container');
        const gallery = document.getElementById('gallery');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');

        // --- State Variables ---
        let currentPosterIndex = 0;
        let visiblePosters = [];
        const VIEWED_POSTERS_KEY = 'viewedPosters';

        // --- Helper Functions ---
        const getViewedPosters = () => {
            const viewed = localStorage.getItem(VIEWED_POSTERS_KEY);
            return viewed ? new Set(JSON.parse(viewed)) : new Set();
        };

        const setViewedPosters = (viewedSet) => {
            localStorage.setItem(VIEWED_POSTERS_KEY, JSON.stringify(Array.from(viewedSet)));
        };

        const markPosterAsViewed = (element) => {
            const posterId = element.dataset.posterId;
            if (posterId && !element.classList.contains('viewed')) {
                const viewedPosters = getViewedPosters();
                viewedPosters.add(posterId);
                setViewedPosters(viewedPosters);
                element.classList.add('viewed');
            }
        };

        // --- Modal & Lightbox Logic ---
        function updateModalContent(posterElement) {
            markPosterAsViewed(posterElement); // Mark as viewed on navigation
            const img = posterElement.querySelector('img');
            const title = posterElement.querySelector('h3').innerText;
            const description = posterElement.querySelector('p').innerText;
            
            modalImg.src = img.dataset.largeSrc || img.src;
            modalTitle.innerText = title;
            modalDescription.innerText = description;
            modalTitleMobile.innerText = title;
            modalDescriptionMobile.innerText = description;
        }

        function showNextPoster() {
            if (visiblePosters.length === 0) return;
            currentPosterIndex = (currentPosterIndex + 1) % visiblePosters.length;
            updateModalContent(visiblePosters[currentPosterIndex]);
        }

        function showPrevPoster() {
            if (visiblePosters.length === 0) return;
            currentPosterIndex = (currentPosterIndex - 1 + visiblePosters.length) % visiblePosters.length;
            updateModalContent(visiblePosters[currentPosterIndex]);
        }
        
        function openModal(element) {
            visiblePosters = Array.from(gallery.querySelectorAll('.poster-card:not(.hidden)'));
            currentPosterIndex = visiblePosters.indexOf(element);
            
            updateModalContent(element);
            
            document.body.classList.add('modal-open');
            modal.classList.remove('invisible', 'opacity-0');
            setTimeout(() => modalContent.classList.remove('scale-95'), 50);
        }

        function closeModal() {
            document.body.classList.remove('modal-open');
            modalContent.classList.add('scale-95');
            modal.classList.add('opacity-0');
            setTimeout(() => modal.classList.add('invisible'), 300);
        }

        // --- Event Listeners ---
        document.addEventListener('keydown', (event) => {
            if (modal.classList.contains('invisible')) return;
            if (event.key === 'Escape') closeModal();
            if (event.key === 'ArrowRight') showNextPoster();
            if (event.key === 'ArrowLeft') showPrevPoster();
        });

        document.addEventListener('contextmenu', e => { if (e.target.tagName === 'IMG') e.preventDefault() });
        
        window.addEventListener('scroll', () => {
            if (window.scrollY > 200) toTopButton.classList.remove('invisible', 'opacity-0');
            else toTopButton.classList.add('invisible', 'opacity-0');
        });
        
        toTopButton.addEventListener('click', () => window.scrollTo({ top: 0, behavior: 'smooth' }));

        prevBtn.addEventListener('click', (e) => { e.stopPropagation(); showPrevPoster(); });
        nextBtn.addEventListener('click', (e) => { e.stopPropagation(); showNextPoster(); });

        filterContainer.addEventListener('click', (event) => {
            if (event.target.tagName !== 'BUTTON') return;
            
            filterContainer.querySelector('.active').classList.remove('active');
            event.target.classList.add('active');

            const filterValue = event.target.getAttribute('data-filter');

            gallery.querySelectorAll('.poster-card').forEach(item => {
                const itemCategories = item.getAttribute('data-category').split(' ');
                const isMainVisible = item.getAttribute('data-main-visible') !== 'false';

                if (filterValue === 'all') {
                    if (isMainVisible) {
                        item.classList.remove('hidden');
                    } else {
                        item.classList.add('hidden');
                    }
                } else {
                    if (itemCategories.includes(filterValue)) {
                        item.classList.remove('hidden');
                    } else {
                        item.classList.add('hidden');
                    }
                }
            });
        });

        // --- Scroll Animation Logic ---
        const scrollObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('is-visible');
                    scrollObserver.unobserve(entry.target);
                }
            });
        }, { threshold: 0.1 });

        document.querySelectorAll('.animate-on-scroll').forEach(el => {
            scrollObserver.observe(el);
        });

        // --- Initial filter on page load ---
        document.addEventListener('DOMContentLoaded', () => {
            const viewedPosters = getViewedPosters();
            gallery.querySelectorAll('.poster-card').forEach(item => {
                const isMainVisible = item.getAttribute('data-main-visible') !== 'false';
                if (!isMainVisible) {
                    item.classList.add('hidden');
                }

                const posterId = item.dataset.posterId;
                if (posterId && viewedPosters.has(posterId)) {
                    item.classList.add('viewed');
                }
            });
        });

    </script>
</body>
</html>

